// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  // id String @id @default(uuid())
  id            Int            @id @default(autoincrement())
  tinderProfile TinderProfile? // a user could actually have multiple profiles...

  dataFiles OriginalAnonymizedFile[]

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model TinderProfile {
  tinderId         String? @unique
  // usage
  appOpens         Json
  matches          Json
  swipeLikes       Json
  swipePasses      Json
  messagesSent     Json
  messagesReceived Json
  // meta calculated during creation
  messagesMeta     Json
  // relation
  userId           Int     @unique
  user             User    @relation(fields: [userId], references: [id])

  customDataId String?
  customData   CustomData? @relation(fields: [customDataId], references: [id])
}

model CustomData {
  id String @unique

  phoneNumbersExchanged Int
  dateArranged          Int
  dateAttended          Int
  dateCreepy            Int
  dateNoSpark           Int
  multipleDates         Int
  sleptWithFirstDate    Int
  sleptWithEventually   Int
  relationshipsStarted  Int

  // dataProvider?

  TinderProfile TinderProfile[]

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model OriginalAnonymizedFile {
  // id       String    @id @default(uuid())
  id           Int          @id @default(autoincrement())
  dataProvider DataProvider
  file         Json

  userId    Int
  User      User?    @relation(fields: [userId], references: [id])
  createdAt DateTime @default(now())
}

// Non user related
model Waitlist {
  id           Int          @id @default(autoincrement())
  email        String       @db.VarChar(255)
  dataProvider DataProvider
  createdAt    DateTime     @default(now())
  updatedAt    DateTime     @updatedAt
}

// Utils
enum DataProvider {
  TINDER
  HINGE
  BUMBLE
}
